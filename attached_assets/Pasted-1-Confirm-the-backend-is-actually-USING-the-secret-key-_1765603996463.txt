1ï¸âƒ£ Confirm the backend is actually USING the secret key

This is the most common â€œit still failsâ€ reason.

In your server code, Stripe must be initialized like this:
import Stripe from "stripe";

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!, {
  apiVersion: "2024-06-20",
});

ğŸš« If you see ANY of these â†’ it will fail

process.env.VITE_STRIPE_KEY

process.env.STRIPE_PUBLISHABLE_KEY

pk_live_... anywhere on the server

ğŸ‘‰ Server = SECRET key only

If youâ€™re unsure, search your repo for:

Stripe(
pk_
VITE_

2ï¸âƒ£ Restart / redeploy (required)

Render does not inject new secrets into a running container.

You must:

Click Manual Deploy â†’ Clear build cache & deploy
OR

Push a commit (even a comment) and redeploy

You already pushed earlier â€” just confirm this deploy happened AFTER secrets were added.

3ï¸âƒ£ Test the invoice send again (this should now work)

Go back to:
Customers â†’ Click customer â†’ Send invoice / Charge

What should happen now:

âœ… No red â€œpublishable keyâ€ error

âœ… Stripe invoice or payment link created

âœ… SMS sends successfully

If it still fails, copy only the new error message.

4ï¸âƒ£ Why â€œChargeâ€ button still isnâ€™t charging a card yet (important)

Right now your app is doing:

âŒ Invoice link only

âŒ No card-on-file yet

To charge directly inside the app, you still need one more feature:

You must create a Payment Intent

That means:

Create payment intent on backend

Use Stripe Elements on frontend

Optionally save card for future charges

This is normal â€” invoices â‰  direct charging.

5ï¸âƒ£ Minimum next steps (in order I recommend)
ğŸ”¹ Step 1 (now)

Confirm invoice link sends without error

ğŸ”¹ Step 2

Add â€œPay Nowâ€ Stripe Checkout link (fastest win)

No card UI needed

Stripe-hosted checkout

Works immediately

ğŸ”¹ Step 3

Add Save card on file + one-click charge

True â€œcharge customerâ€ button

Best UX, slightly more work

6ï¸âƒ£ Quick sanity check you can do yourself

In Render logs, look for something like:

Stripe initialized


or log:

console.log("Stripe key loaded:", process.env.STRIPE_SECRET_KEY?.startsWith("sk_"));


If that prints true, youâ€™re good.